<template>
    <div id="groupBy" class="groupBy"
    style="background: url(static/img/tree.jpg) no-repeat center center; 
    background-size: cover;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    position:relative;
    z-index: 1;"
    >
        <!--backlog item begin-->
        <transition name="fade" mode="out-in" appear>
      <div class="po-test-side-list" v-show='showBackLogList'>
          <div class="po-side-list-header">
              <i-button id="closeBackLog" size="small" class="pull-right" @click="closeBackLog">
                <Icon  type="close-round"></Icon>
              </i-button>
              <div class="pull-left" title="">
                  <p class='left title-common ' :class="'backlog'+backLogIcon" >
                    <span v-if='backLogRootPath.text'>release backlog</span>
                    <span v-if='backLogFolderPath.text'>werwqre</span>
                  </p>
              </div>
        </div>
        <div class="po-side-list-content" id='po-side-list-content'>
              <table cellpadding="0" cellspacing="0" width="100%;" class='backLogList container' v-dragula="backLogList" service="shared-service" drake="drakecopy">
                <tr v-for="backLogItem in backLogList" :key="backLogItem"  class="list_row" >
                    <td><a href="javascript:void();">{{ backLogItem }}</a></td>
                </tr>
                <tr id='newItemTemplate' class="list_row" style='display:none;'>
                    <td><a href="javascript:void();">#backLogItem#</a></td>
                </tr>
              </table>
         </div>
      </div>
    </transition>
        <!-- backlog item end-->
        <div class="wrapper" :class="{hasLeftoffset: showBackLogList, hasRightoffset: showEditPanel}">
            <div class="statusbar">
                <div id="toDo"
                    status="1"
                    class="status-todo status-title-common boards-status-title row left"> 
                    To Do
                    <span class="right"></span>
                </div>
                <div id="inProgress"
                    status="2"
                    class="status-inprogress status-title-common boards-status-title row left">
                    In Progress
                <span class="right"></span>
                </div>
                <div id="qaVerify"
                    status="3"
                    class="status-verify status-title-common boards-status-title row left">
                    Testing
                <span class="right"></span>
                </div>
                <div id="done"
                    status="4"
                    class="status-done status-title-common boards-status-title row">
                    In Review
                    <span class="right"></span>
                </div>
                <div id="toDo"
                    status="1"
                    class="status-todo status-title-common boards-status-title row"> 
                   Approved
                    <span class="right"></span>
                </div>
                <div id="inProgress"
                    status="2"
                    class="status-inprogress status-title-common boards-status-title row">
                Selected task
                <span class="right"></span>
                </div>
                <div id="qaVerify"
                    status="3"
                class="status-verify status-title-common boards-status-title row">
                In Testing
                <span class="right"></span>
                </div>
                <div id="done"
                    status="4"
                    class="status-done status-title-common boards-status-title row">
                Done
                    <span class="right"></span>
                </div>

                <div class="groupbycontent" >
                  <div class="lane-head" swimlane-id="1" >
                  <Button-group>
                    <Button type="ghost" @click="togglesection" icon="chevron-up" title="toggle on/off" style="border-top:none;border-bottom:none;"></Button>
                  </Button-group>
                      <span>Terry-J</span>
                  </div>
                  <div>
                      <div v-for="(statusInfo,$index1) in statusInfos" :key="$index1" class="container">
                          <div v-dragula="box"
                            service="shared-service-groupby"
                            drake="drakecopy" class="status-wrapper" :status="$index1">
                          <div
                              class="action-card"
                              :status="task.status"
                              v-for="(task,$index2) in statusInfo.statusInfo"
                              :key="task.cardId"
                              v-bind:taskid="task.cardId"
                              @click.capture="showCardDetails($event,$index1,$index2)"
                              :class="{'active':task.active,'unactive':!task.active}"
                          >
                              <div class="card-content">
                              <p class="bg-content content-tz right"
                                  :class=task.cardType
                                  v-if="task.cardType !== ''"
                              >{{task.cardType | uppercase}}</p>
                              <h4 class="card-msg">
                                  {{task.cardMsg}}
                              </h4>
                              </div>
                              <div class="card-meta">
                              <div class="card-properties left">
                                  <i class="icon-planlet"></i>
                                  <i class="icon-calendar">
                                  {{task.cardCalendar}}
                                  </i>
                              </div>
                              <span class="id-badge right">ID{{task.cardId}}</span>
                              <div class="clearfix"></div>
                              </div>
                          </div>
                                            <div class="add-card-box" id="add-card-box" title="New Task">
                    <span class="icon-ad"></span>
                  </div>
                          </div>
                      </div>
                      <!-- hide-->
                  <div
                    id='newTaskTemplate'
                    class="action-card"
                    style='display:none;'
                  >
                    <div class="card-content">
                      <p
                        class="bg-content right tz"
                        :class=cardInfo.cardType
                        v-if="cardInfo.cardType !== ''"
                      >#taskowner#</p>
                      <h4 class="card-msg">
                        #cardInfo.cardMsg#
                      </h4>
                    </div>
                    <div class="card-meta">
                      <div class="card-properties left">
                        <i class="icon-planlet"></i>
                        <i class="icon-calendar">
                          #datetime#
                        </i>
                      </div>
                      <span class="id-badge right">#taskid#</span>
                      <div class="clearfix"></div>
                    </div>
                  </div>
                  <!--end hide-->
                  </div>

                  <div class="lane-head" swimlane-id="1">
                  <Button-group>
                    <Button type="ghost" @click="togglesection" icon="chevron-up" title="toggle on/off" style="border-top:none;border-bottom:none;"></Button>
                  </Button-group>
                      <span>James-R</span>
                  </div>
                  <div >
                      <div v-for="(statusInfo,$index1) in statusInfos" :key="$index1" class="container">
                          <div v-dragula="box"
                            service="shared-service-groupby"
                            drake="drakecopy" class="status-wrapper" :status="$index1">
                            <div
                                class="action-card"
                                status="1"
                                v-for="(task,$index2) in statusInfo.statusInfo"
                                :key="task.cardId"
                                v-bind:taskid="task.cardId"
                                @click.capture="showCardDetails($event,$index1,$index2)"
                                :class="{'active':task.active,'unactive':!task.active}"
                            >
                                <div class="card-content">
                                <p class="bg-content content-tz right"
                                    :class=task.cardType
                                    v-if="task.cardType !== ''"
                                >{{task.cardType | uppercase}}</p>
                                <h4 class="card-msg">
                                    {{task.cardMsg}}
                                </h4>
                                </div>
                                <div class="card-meta">
                                <div class="card-properties left">
                                    <i class="icon-planlet"></i>
                                    <i class="icon-calendar">
                                    {{task.cardCalendar}}
                                    </i>
                                </div>
                                <span class="id-badge right">ID{{task.cardId}}</span>
                                <div class="clearfix"></div>
                                </div>
                            </div>
                          </div>
                      </div>
                  </div>
              </div>
            </div>
        </div>
    </div>
</template>
<script>
    import editPanel from '../../common/editPanel/EditPanel';
    import {mapState,mapMutations,mapActions} from 'vuex';
    export default {
        created(){
            this.adjustWidth();
        },
        mounted() {
            this.initGUI();
        },
       data: function() {
           return {
               statusInfos: [
                {
                    statusInfo: [
                        { status:1,
                            cardType: "tz",
                            cardName: 'Tim Zero',
                            cardMsg:"DT10.1-(DevTrack IE)In IE browser,preview the document as PDF/word/PPT,but it can't display anything",
                            cardCalendar:"Feb 17",
                            cardImage:"",
                            cardId:15},
                        { status:1,
                            cardType: "jc",
                            cardName: 'Jimery Cook',
                            cardMsg:"Moving them anywhere else isn't quite possible",
                            cardCalendar:"Feb 17",
                            cardImage:"",
                            cardId:36 },
                        { status:1,
                            cardType: "ww",
                            cardName: 'William Wall',
                            cardMsg:"You should check any other nested elements",
                            cardCalendar:"Feb 17",
                            cardImage:"",
                            cardId:37 },
                        { status:1,
                            cardType: "ww",
                            cardName: 'William Wall',
                            cardMsg:"You should check any other nested elements",
                            cardCalendar:"Feb 17",
                            cardImage:"",
                            cardId:47 }
                        ]
                },
                {
                    statusInfo: [
                        { status:2,
                            cardType: "jz",
                            cardName: 'Jimery Zero',
                            cardMsg:"There's also the possibility of moving elements around in the same container, changing their position",
                            cardCalendar:"Feb 19",
                            cardImage:"",
                            cardId:56},
                        { status:2,
                            cardType: "tz",
                            cardName: 'Tim Zero',
                            cardMsg:"This is the default use case. You only need to specify the containers you want to use",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:40},
                        { status:2,
                            cardType: "ph",
                            cardName: 'Phillips',
                            cardMsg:"Moving element",
                            cardCalendar:"Feb 17",
                            cardImage:"static/img/demo.png",
                            cardId:58},
                            { status:2,
                            cardType: "tz",
                            cardName: 'Tim Zero',
                            cardMsg:"There's also the possibility of moving elements around in the same container, changing their position",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:165},
                        { status:2,
                            cardType: "jz",
                            cardName: 'Jimery Zero',
                            cardMsg:"Moving them anywhere else isn't quite possible",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:167},
                        { status:2,
                            cardType: "ww",
                            cardName: 'William Wall',
                            cardMsg:"Anything can be moved around. That includes img, or any other nested elements.",
                            cardCalendar:"Feb 17",
                            cardImage:"static/img/demo1.png",
                            cardId:166}
                    ]
                },
                {
                    statusInfo: [
                        { status:3,
                            cardType: "tj",
                            cardName: 'Terry Johson',
                            cardMsg:"DT10.1-(DevTrack IE)In IE browser,preview the document as PDF/word/PPT,but it can't display anything.",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:45},
                        { status:3,
                            cardType: "ph",
                            cardName: 'Philiam Wall',
                            cardMsg:"Moving them anywhere else isn't quite possible",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:78},
                        { status:3,
                            cardType: "jc",
                            cardName: 'Jimery Cook',
                            cardMsg:"Anything can be moved around. That includes img, or any other nested elements.",
                            cardCalendar:"Feb 17",
                            cardImage:"",
                            cardId:25}
                    ]
                },
                {
                    statusInfo: [
                        { status:4,
                            cardType: "tz",
                            cardName: 'Tim Zero',
                            cardMsg:"There's also the possibility of moving elements around in the same container, changing their position",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:65},
                        { status:4,
                            cardType: "jz",
                            cardName: 'Jimery Zero',
                            cardMsg:"Moving them anywhere else isn't quite possible",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:67},
                        { status:4,
                            cardType: "ww",
                            cardName: 'William Wall',
                            cardMsg:"Anything can be moved around. That includes img, or any other nested elements.",
                            cardCalendar:"Feb 17",
                            cardImage:"static/img/demo1.png",
                            cardId:66}
                    ]
                },
                {
                    statusInfo:[
                        { status:4,
                            cardType: "tz",
                            cardName: 'Tim Zero',
                            cardMsg:"There's also the possibility of moving elements around in the same container, changing their position",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:65},
                        { status:4,
                            cardType: "jz",
                            cardName: 'Jimery Zero',
                            cardMsg:"Moving them anywhere else isn't quite possible",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:67},
                        { status:4,
                            cardType: "ww",
                            cardName: 'William Wall',
                            cardMsg:"Anything can be moved around. That includes img, or any other nested elements.",
                            cardCalendar:"Feb 17",
                            cardImage:"static/img/demo1.png",
                            cardId:66}              
                    ]
                },
                {
                    statusInfo:[
                        { status:3,
                            cardType: "tj",
                            cardName: 'Terry Johson',
                            cardMsg:"DT10.1-(DevTrack IE)In IE browser,preview the document as PDF/word/PPT,but it can't display anything.",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:45},
                        { status:3,
                            cardType: "ph",
                            cardName: 'Philiam Wall',
                            cardMsg:"Moving them anywhere else isn't quite possible",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:78},
                        { status:3,
                            cardType: "jc",
                            cardName: 'Jimery Cook',
                            cardMsg:"Anything can be moved around. That includes img, or any other nested elements.",
                            cardCalendar:"Feb 17",
                            cardImage:"",
                            cardId:25}              
                    ]
                },
                {
                    statusInfo:[
                        { status:2,
                            cardType: "jz",
                            cardName: 'Jimery Zero',
                            cardMsg:"There's also the possibility of moving elements around in the same container, changing their position",
                            cardCalendar:"Feb 19",
                            cardImage:"",
                            cardId:56},
                        { status:2,
                            cardType: "tz",
                            cardName: 'Tim Zero',
                            cardMsg:"This is the default use case. You only need to specify the containers you want to use",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:40},
                        { status:2,
                            cardType: "ph",
                            cardName: 'Phillips',
                            cardMsg:"Moving element",
                            cardCalendar:"Feb 17",
                            cardImage:"static/img/demo.png",
                            cardId:58},
                            { status:2,
                            cardType: "tz",
                            cardName: 'Tim Zero',
                            cardMsg:"There's also the possibility of moving elements around in the same container, changing their position",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:165},
                        { status:2,
                            cardType: "jz",
                            cardName: 'Jimery Zero',
                            cardMsg:"Moving them anywhere else isn't quite possible",
                            cardCalendar:"",
                            cardImage:"",
                            cardId:167},
                        { status:2,
                            cardType: "ww",
                            cardName: 'William Wall',
                            cardMsg:"Anything can be moved around. That includes img, or any other nested elements.",
                            cardCalendar:"Feb 17",
                            cardImage:"static/img/demo1.png",
                            cardId:166}              
                    ]
                },
                {
                    statusInfo:[
                        { status:1,
                            cardType: "tz",
                            cardName: 'Tim Zero',
                            cardMsg:"DT10.1-(DevTrack IE)In IE browser,preview the document as PDF/word/PPT,but it can't display anything",
                            cardCalendar:"Feb 17",
                            cardImage:"",
                            cardId:15},
                        { status:1,
                            cardType: "jc",
                            cardName: 'Jimery Cook',
                            cardMsg:"Moving them anywhere else isn't quite possible",
                            cardCalendar:"Feb 17",
                            cardImage:"",
                            cardId:36 },
                        { status:1,
                            cardType: "ww",
                            cardName: 'William Wall',
                            cardMsg:"You should check any other nested elements",
                            cardCalendar:"Feb 17",
                            cardImage:"",
                            cardId:37 },
                        { status:1,
                            cardType: "ww",
                            cardName: 'William Wall',
                            cardMsg:"You should check any other nested elements",
                            cardCalendar:"Feb 17",
                            cardImage:"",
                            cardId:47 }              
                    ]
                }
                ],
              groupByInfos: [
                {
                    user_name: "Terry Johnson",
                    user_id: 13,
                    tasks: [
                        { status:1,
                        cardType: "tz",
                        cardName: 'Tim Zero',
                        cardMsg:"DT10.1-(DevTrack IE)In IE browser,preview the document as PDF/word/PPT,but it can't display anything",
                        cardCalendar:"Feb 17",
                        cardImage:"",
                        cardId:15},
                        { status:1,
                        cardType: "jc",
                        cardName: 'Jimery Cook',
                        cardMsg:"Moving them anywhere else isn't quite possible",
                        cardCalendar:"Feb 17",
                        cardImage:"",
                        cardId:36 },
                        { status:1,
                        cardType: "ww",
                        cardName: 'William Wall',
                        cardMsg:"You should check any other nested elements",
                        cardCalendar:"Feb 17",
                        cardImage:"",
                        cardId:37 },
                        { status:1,
                        cardType: "ww",
                        cardName: 'William Wall',
                        cardMsg:"You should check any other nested elements",
                        cardCalendar:"Feb 17",
                        cardImage:"",
                        cardId:47 }
                    ]
                }
               ],
            box: [],
            cardInfo: '',
            todocardInfo: '',
            processcardInfo: '',
            verifycardInfo: '',
            donecardInfo: '',
            backLogList:["teswt","this is remove"]
            }
       },
       computed: {
           ...mapState(['storeAllStatus','showTestRunList','showEditPanel','backLogRootPath','backLogFolderPath','showBackLogList']),
           backLogIcon() {
                if ((this.backLogRootPath.text == '') && (this.backLogFolderPath.text =='')) {
                    return this.$store.state.backLogRootPath.subType;
                }else {
                    return this.$store.state.backLogRootPath.subType;
                }
            }
       },
       methods: {
          togglesection: function(e) {
            if($(e.currentTarget).parent().parent().next(':visible').length > 0){
            $(e.currentTarget).parent().parent().next(':visible').hide();
            $(e.currentTarget).find('i').attr('class','ivu-icon ivu-icon-chevron-down');
            }
            else{
                $(e.currentTarget).parent().parent().next().show();
                $(e.currentTarget).find('i').attr('class','ivu-icon ivu-icon-chevron-up');
            }
          },
          initGUI: function() {
            $('.po-test-side-list').height(window.innerHeight-107);
            $('.groupbycontent').height(window.innerHeight-165).width(window.innerWidth).css('max-width','3210px').
                css('position','relative').css('overflow-y','scroll').css('overflow-x','hidden');
            $('.boardcontent ').height(window.innerHeight-163);
            $('#testrun').height(window.innerHeight-107).width(window.innerWidth);
            $('.statusbar').height(window.innerHeight-109);

            var offset_left = 0;
            $('.statusbar').on('scroll',function(){ 
            $('.groupbycontent').width($('.groupbycontent').width()+$('.statusbar').scrollLeft()-offset_left);
            offset_left = $('.statusbar').scrollLeft();
            });
          },
          adjustWidth() {
              if( showBackLogList == false) {
                  $('.wrapper').width(window.innerHeight-350)
              }else {
                   $('.statusbar').width();
              }
          },
          closeBackLog() {
            this.switchBackLog({backLoglist:false});
          },
          showCardDetails(e,i1,i2) {
              
          },
          ...mapMutations(['switchBackLog','changeEditPanelStatus'])
       },
       components: {
           editPanel
       }
    }
</script>
<style lang="scss" scoped="" type="text/css">
  @import 'groupBy.scss';
  @import 'poptip.scss';
  @import '../../../../static/grid_media.css';
</style>